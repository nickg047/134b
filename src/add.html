<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Add a habit</title>
		<link rel="stylesheet" href="../css/forms.css">
	</head>
	<body>

		<div class="forms">
			<h2>Add A Habit</h2>
			<form>
				<p><label><span id="title_text">Habit Title</span></label></p>
				<p><input id="title" type="text" name="fullname" placeholder="Exercise 30 minutes"></p>
				<p><label>Habit Icon</label></p>
				<img id="icon1" class="icon" onclick="selectImage('icon1');" src="../img/sleep.jpg" alt="sleep image"/>
				<img id="icon2" class="icon" onclick="selectImage('icon2');" src="../img/salad.jpg" alt="eat image"/>
				<img id="icon3" class="icon" onclick="selectImage('icon3');" src="../img/run.jpg" alt="run image"/>
				<img id="icon4" class="icon" src="../img/add.png" alt="find a image"/>
				<p><label>Weekly Frequency</label></p>
				<div id="ck-button">
					<label> <input type="checkbox" name="date" value="sunday"><span>Sun</span></label>
					<label> <input type="checkbox" name="date" value="monday"><span>Mon</span></label>
					<label> <input type="checkbox" name="date" value="tuesday"><span>Tues</span></label>
					<label> <input type="checkbox" name="date" value="wednesday"><span>Wed</span></label>
					<label> <input type="checkbox" name="date" value="thursday"><span>Thur</span></label>
					<label> <input type="checkbox" name="date" value="friday"><span>Fri</span></label>
					<label> <input type="checkbox" name="date" value="saturday"><span>Sat</span></label>
				</div>
		
		
				<p><label>Daily Frequency</label></p>
				<div id="daily-button">
					<label> <input type="checkbox" name="day" value="one"><span>1</span></label>
					<label> <input type="checkbox" name="day" value="two"><span>2</span></label>
					<label> <input type="checkbox" name="day" value="three"><span>3</span></label>
					<span id="times">times</span>
				</div>
				<p><label><span id="others_text">Others: </span><input id="others" type="text" name="day" placeholder="More than 3 times"></label></p>
				<p id="save_p"><input id="save" type="button" value="Save It" onclick="location.href='list.html'; addHabit();"></p>
				
			</form>

		</div>
		<script>
		    image = null;

            function selectImage(name) {
            //Clear all the other effects
                document.getElementById('icon1').style.border = "none";
                document.getElementById('icon2').style.border = "none";
                document.getElementById('icon3').style.border = "none";
                image = document.getElementById(name);
                image.style.border = "5px solid #42A5F5";
            }

            function addHabit() {       
                if ('localStorage' in window && window['localStorage'] !== null) {
			        try {
			            //Get stored data
			            var habits = JSON.parse(localStorage.getItem('Habits'));
			            var i;
			            if (habits === null) {
			                //If no stored data, create empty array
			                habits = [];
			                i = 0;
			            }
			            else {
			            	i = habits[habits.length-1].id + 1;
			            }

			            //Create new user entry
			            var habit = {
			            	id: i,
			                title: document.getElementById('title').value,
			                image: image.id,
			                weekFreq: getCheckedBoxes('date'),
			                dailyFreq: getCheckedBoxes('day'),
			                other: document.getElementById('others').value
			            };

			            //Add new entry to stored array
			            habits.push(habit);

			            //Save array
			            localStorage.setItem("Habits", JSON.stringify(habits));
			            return true;

			        } catch (e) {
			            alert(e);
			        }
			    } else {
			        alert('Cannot store user preferences as your browser do not support local storage');
			    }
            }
            function getCheckedBoxes(chkboxName) {
                var checkboxes = document.getElementsByName(chkboxName);
                var checkboxesChecked = [];
                for (var i=0; i<checkboxes.length; i++) {
                    if (checkboxes[i].checked) {
                        checkboxesChecked.push(checkboxes[i].value);
                    }
                }
                return checkboxesChecked.length > 0 ? checkboxesChecked : null;
            }
		</script>
	</body>
</html>
